(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{299:function(a,e,s){"use strict";s.r(e);var t=s(8),r=Object(t.a)({},(function(){var a=this,e=a._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"在docker上部署paddleocr服务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#在docker上部署paddleocr服务"}},[a._v("#")]),a._v(" 在docker上部署PaddleOCR服务")]),a._v(" "),e("p",[e("a",{attrs:{href:"https://blog.csdn.net/apple_50678962/article/details/120731730",target:"_blank",rel:"noopener noreferrer"}},[a._v("参考"),e("OutboundLink")],1)]),a._v(" "),e("p",[e("strong",[a._v("拉取预安装 PaddlePaddle 的镜像：")])]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" pull registry.baidubce.com/paddlepaddle/paddle:2.3.2\n")])])]),e("p",[e("strong",[a._v("运行docker容器：")])]),a._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[a._v("docker run "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),a._v("name ppocr "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("v "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("opt"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("paddle"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("opt"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("paddle "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),a._v("network"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("host "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("it registry"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("baidubce"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("com"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("paddlepaddle"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("paddle"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("2.3")]),e("span",{pre:!0,attrs:{class:"token number"}},[a._v(".2")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("bin"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("bash\n# 或自己导出导入镜像\ndocker commit "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("容器id"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" ppocr"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("1.0")]),a._v("\ndocker save "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("o ppocr_1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("tar ppocr"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("1.0")]),a._v("\ndocker load "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),a._v("input ppocr_1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("tar\ndocker run "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),a._v("name ppocr "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("v "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("opt"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("paddle"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("opt"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("paddle "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),a._v("network"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("host "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("itd ppocr"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("1.0")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("bin"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("bash\n")])])]),e("ul",[e("li",[a._v('基于PaddleHub Serving的部署：代码路径为"'),e("code",[a._v("PaddleOCR/deploy/hubservingg")]),a._v('" 已集成到PaddleOCR中（'),e("a",{attrs:{href:"https://github.com/PaddlePaddle/PaddleOCR/tree/develop/deploy/hubserving",target:"_blank",rel:"noopener noreferrer"}},[a._v("code"),e("OutboundLink")],1),a._v("）")])]),a._v(" "),e("blockquote",[e("p",[a._v("当前用户在训练出一个可用的模型后，可以选择如下四种部署应用方式：")]),a._v(" "),e("p",[a._v("服务器端高性能部署：将模型部署在服务器上，利用服务器的高性能帮助用户处理推理业务\n模型服务化部署：将模型以线上服务的形式部署在服务器或云端，用户通过客户端请求发送需要推理的输入内容，服务器或者云通过相应报文将推理结果返回给用户（paddle serving）\n移动端部署：将模型部署在移动端上，例如手机/物联网的嵌入式端\nWeb端部署：将模型部署在网页上，用户通过网页完成推理业务")])]),a._v(" "),e("p",[a._v("PaddlehubServing作为paddlepaddle开源的在线服务框架")]),a._v(" "),e("p",[a._v("服务部署下包括 检测、识别、检测+识别串联 三种服务包，根据需求选择相应的服务包进行安装和启动")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("deploy/hubserving/\n└─  ocr_det     检测模块服务包\n└─  ocr_rec     识别模块服务包\n└─  ocr_system  检测+识别串联服务包   <==== 我们直接这个，包括先检测然后识别\n")])])]),e("p",[a._v("每个服务包下包含3个文件。以检测+识别串联 目录为例，目录如下：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("deploy/hubserving/ocr_system/\n└─  __init__.py    空文件，必选\n└─  config.json    配置文件，可选，使用配置启动服务时作为参数传入\n└─module.py      主模块，必选，包含服务的完整逻辑\n└─params.py      参数文件，必选，包含模型路径、前后处理参数等参数\n")])])]),e("h2",{attrs:{id:"具体步骤-ocr-system-检测-识别串联"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#具体步骤-ocr-system-检测-识别串联"}},[a._v("#")]),a._v(" 具体步骤（ocr_system 检测+识别串联）")]),a._v(" "),e("h3",{attrs:{id:"_1、准备环境"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1、准备环境"}},[a._v("#")]),a._v(" 1、准备环境")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 安装paddlehub ")]),a._v("\npip "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" paddlehub "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--upgrade")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-i")]),a._v(" https://pypi.tuna.tsinghua.edu.cn/simple\n")])])]),e("h3",{attrs:{id:"_2、从git-clone-下载下来整个paddleocr项目"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2、从git-clone-下载下来整个paddleocr项目"}},[a._v("#")]),a._v(" 2、从git clone/下载下来整个PaddleOCR项目")]),a._v(" "),e("ul",[e("li",[a._v("也可在本地下载压缩包后上传服务器")]),a._v(" "),e("li",[a._v("进入需要保存的工作目录拉取项目即可")])]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("git")]),a._v(" clone https://gitee.com/paddlepaddle/PaddleOCR\n")])])]),e("ul",[e("li",[a._v("安装 PaddleOCR 的 python 依赖")])]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" PaddleOCR\npip3 "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-r")]),a._v(" requirements.txt\n")])])]),e("h3",{attrs:{id:"_3-下载推理模型"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-下载推理模型"}},[a._v("#")]),a._v(" 3.下载推理模型")]),a._v(" "),e("p",[a._v("下载/使用自己的推理模型并放到正确路径：")]),a._v(" "),e("blockquote",[e("p",[a._v("若不手动下载则会自动下载并使用默认配置中的模型")])]),a._v(" "),e("p",[a._v("1、在PaddleOCR（也就是刚刚解压的目录下面）目录里"),e("code",[a._v("mkdir inference")]),a._v("创建 inference 目录")]),a._v(" "),e("p",[a._v("2、从PaddleOCR提供的模型库下载以下三个模型压缩包")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("检测模型：ch_ppocr_server_v2.0_det_infer.tar\n识别模型：ch_ppocr_server_v2.0_rec_infer.tar\n方向分类器：ch_ppocr_mobile_v2.0_cls_infer\n\n# 在inference目录下载并解压 OCR 文本检测模型\nwget https://paddleocr.bj.bcebos.com/PP-OCRv3/chinese/ch_PP-OCRv3_det_infer.tar -O ch_PP-OCRv3_det_infer.tar && tar -xf ch_PP-OCRv3_det_infer.tar\n# 下载并解压 OCR 文本识别模型\nwget https://paddleocr.bj.bcebos.com/PP-OCRv3/chinese/ch_PP-OCRv3_rec_infer.tar -O ch_PP-OCRv3_rec_infer.tar && tar -xf ch_PP-OCRv3_rec_infer.tar\n# 下载并解压 OCR 文本方向分类模型\nwget https://paddleocr.bj.bcebos.com/dygraph_v2.0/ch/ch_ppocr_mobile_v2.0_cls_infer.tar -O ch_ppocr_mobile_v2.0_cls_infer.tar && tar -xf ch_ppocr_mobile_v2.0_cls_infer.tar\n")])])]),e("p",[a._v("3、也可以把压缩包上传到"),e("code",[a._v("Paddle/inference")]),a._v("目录里，解压")]),a._v(" "),e("p",[a._v("4、检查一下解压出来的目录中，是否包含以下内容")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("./inference/ch_PP-OCRv3_det_infer/\n└─  inference.pdiparams\n└─  inference.pdiparams.info\n└─  inference.pdmodel  \n\n./inference/ch_PP-OCRv3_rec_infer/\n└─ ._inference.pdiparams\n└─ inference.pdiparams\n└─ ._inference.pdiparams.info\n└─ inference.pdiparams.info\n└─ ._inference.pdmodel\n└─ inference.pdmodel\n\n./inference/ch_ppocr_mobile_v2.0_cls_infer/\n└─  inference.pdiparams\n└─  inference.pdiparams.info\n└─  inference.pdmodel  \n")])])]),e("h3",{attrs:{id:"_4、修改参数文件params-py中的模型路径"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4、修改参数文件params-py中的模型路径"}},[a._v("#")]),a._v(" 4、修改参数文件"),e("code",[a._v("params.py")]),a._v("中的模型路径")]),a._v(" "),e("p",[a._v("因为我们这里是安装部署"),e("code",[a._v("ocr_sysyem")]),a._v("，所以就去改"),e("code",[a._v("ocr_system")]),a._v("的就ok。若要更换自己训练的模型也是如此操作。\n"),e("code",[a._v("ocr_system")]),a._v("参数文件路径："),e("code",[a._v("PaddleOCR/")])]),a._v(" "),e("p",[a._v("修改以下部分：")]),a._v(" "),e("p",[e("img",{attrs:{src:"https://minboo-blog-img.oss-cn-guangzhou.aliyuncs.com/img/image-20230416211649233.png",alt:"image-20230416211649233"}})]),a._v(" "),e("p",[e("img",{attrs:{src:"https://minboo-blog-img.oss-cn-guangzhou.aliyuncs.com/img/image-20230416211723900.png",alt:"image-20230416211723900"}})]),a._v(" "),e("h3",{attrs:{id:"_5、安装服务模块"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5、安装服务模块"}},[a._v("#")]),a._v(" 5、安装服务模块")]),a._v(" "),e("p",[a._v("PaddleOCR提供3种服务模块，根据需要安装所需模块。（这里我们是安装的ocr_system）")]),a._v(" "),e("p",[a._v("在 PaddleOCR 这个目录下运行")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("安装检测服务模块：\nhub install deploy/hubserving/ocr_det/\n\n或，安装识别服务模块：\nhub install deploy/hubserving/ocr_rec/\n\n或，安装检测+识别串联服务模块：\nhub install deploy/hubserving/ocr_system/  <=== 我们选择这个\n")])])]),e("p",[a._v("这样算成功")]),a._v(" "),e("p",[e("img",{attrs:{src:"https://minboo-blog-img.oss-cn-guangzhou.aliyuncs.com/img/image-20230416214932886.png",alt:"image-20230416214932886"}})]),a._v(" "),e("h2",{attrs:{id:"启动服务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#启动服务"}},[a._v("#")]),a._v(" 启动服务")]),a._v(" "),e("h3",{attrs:{id:"配置文件启动-支持cpu、gpu"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#配置文件启动-支持cpu、gpu"}},[a._v("#")]),a._v(" 配置文件启动（支持CPU、GPU）")]),a._v(" "),e("p",[e("strong",[a._v("启动命令：")]),a._v(" "),e("code",[a._v("hub serving start -c config.json")])]),a._v(" "),e("p",[e("strong",[a._v("或")]),a._v("(推荐)")]),a._v(" "),e("p",[e("code",[a._v("hub serving start -m ocr_system")])]),a._v(" "),e("p",[e("strong",[a._v("启动成功")])]),a._v(" "),e("p",[e("img",{attrs:{src:"https://minboo-blog-img.oss-cn-guangzhou.aliyuncs.com/img/image-20230416215457884.png",alt:"image-20230416215457884"}})]),a._v(" "),e("p",[e("strong",[a._v("停止")])]),a._v(" "),e("p",[e("code",[a._v("hub serving stop -p 8866")])]),a._v(" "),e("p",[a._v("其中，"),e("code",[a._v("config.json")]),a._v("格式如下：")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"modules_info"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"ocr_system"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"init_args"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n                "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"version"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"1.0.0"')]),a._v(",\n                "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"use_gpu"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" true, "),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#是否使用gpu，如果是cpu机器则设置成false，use_gpu不可与use_multiprocess同时为true")]),a._v("\n                "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"enable_mkldnn"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),a._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(",\n            "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"predict_args"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(",\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"port"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("8866")]),a._v(", "),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 服务端口")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"use_multiprocess"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" false, "),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 是否使用多进程，默认为单进程，多核cpu可改为true")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"workers"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 在并发方式下指定的并发任务数，默认为2*cpu_count-1，其中cpu_count为CPU核数")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),e("ul",[e("li",[e("p",[e("code",[a._v("init_args")]),a._v("中的可配参数与"),e("code",[a._v("module.py")]),a._v("中的"),e("code",[a._v("_initialize")]),a._v("函数接口一致。其中，当"),e("code",[a._v("use_gpu")]),a._v("为"),e("code",[a._v("true")]),a._v("时，表示使用GPU启动服务")])]),a._v(" "),e("li",[e("p",[e("code",[a._v("predict_args")]),a._v("中的可配参数与"),e("code",[a._v("module.py")]),a._v("中的"),e("code",[a._v("predict")]),a._v("函数接口一致。")])])]),a._v(" "),e("p",[e("strong",[a._v("注意:")])]),a._v(" "),e("ul",[e("li",[a._v("使用配置文件启动服务时，其他参数会被忽略。")]),a._v(" "),e("li",[a._v("如果使用GPU预测(即，"),e("code",[a._v("use_gpu")]),a._v("置为"),e("code",[a._v("true")]),a._v(")，则需要在启动服务之前，设置"),e("code",[a._v("CUDA_VISIBLE_DEVICES")]),a._v("环境变量，如："),e("code",[a._v("export CUDA_VISIBLE_DEVICES=0")]),a._v("，否则不用设置。")]),a._v(" "),e("li",[e("code",[a._v("use_gpu")]),a._v("不可与"),e("code",[a._v("use_multiprocess")]),a._v("同时为"),e("code",[a._v("true")]),a._v("。")]),a._v(" "),e("li",[e("strong",[e("code",[a._v("use_gpu")]),a._v("与"),e("code",[a._v("enable_mkldnn")]),a._v("同时为"),e("code",[a._v("true")]),a._v("时，将忽略"),e("code",[a._v("enable_mkldnn")]),a._v("，而使用GPU")]),a._v("。")])]),a._v(" "),e("h2",{attrs:{id:"发送预测请求"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#发送预测请求"}},[a._v("#")]),a._v(" 发送预测请求")]),a._v(" "),e("p",[a._v("配置好服务端，可使用以下命令发送预测请求，获取预测结果:")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("python tools/test_hubserving.py "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--server_url")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("serverurl"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--image_dir")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("image_path"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("需要给脚本传递2个参数：\n")])])]),e("p",[e("code",[a._v("server_url")]),a._v("：服务地址，格式为\n"),e("code",[a._v("http://[ip_address]:[port]/predict/[module_name]")]),a._v("\n例如，如果使用配置文件启动检测、识别、检测+识别2阶段服务，那么发送请求的url将分别是：\n"),e("code",[a._v("http://127.0.0.1:8866/predict/ocr_det")]),a._v(" "),e("code",[a._v("http://127.0.0.1:8867/predict/ocr_rec")]),a._v(" "),e("code",[a._v("http://127.0.0.1:8868/predict/ocr_system")]),a._v(" "),e("code",[a._v("image_path")]),a._v("：测试图像路径，可以是单张图片路径，也可以是图像集合目录路径\n这里我挂起服务之后用对本机请求测试了一下示例：")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("python tools/test_hubserving.py "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--server_url")]),a._v(" http://127.0.0.1:8866/predict/ocr_system "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--image_dir")]),a._v(" ./aaa.jpg\n")])])]),e("p",[a._v("找张有文字的图片传到服务器上，路径写在image_path参数位置，测试结果如下\n"),e("img",{attrs:{src:"C:%5CUsers%5C11973%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20221005171950353.png",alt:"image-20221005171950353"}})]),a._v(" "),e("p",[a._v("Postman测试：")]),a._v(" "),e("p",[a._v("在postman中输入接口url"),e("code",[a._v("ip:8866/predict/ocr_system")]),a._v("，post请求，参数为json对象如下图")]),a._v(" "),e("p",[e("img",{attrs:{src:"C:%5CUsers%5C11973%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20221005172523299.png",alt:"image-20221005172523299"}})]),a._v(" "),e("p",[a._v("返回结果：")]),a._v(" "),e("p",[e("img",{attrs:{src:"C:%5CUsers%5C11973%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20221005172630879.png",alt:"image-20221005172630879"}})]),a._v(" "),e("table",[e("thead",[e("tr",[e("th",[a._v("字段名称")]),a._v(" "),e("th",[a._v("数据类型")]),a._v(" "),e("th",[a._v("含义")])])]),a._v(" "),e("tbody",[e("tr",[e("td",[a._v("text")]),a._v(" "),e("td",[a._v("str")]),a._v(" "),e("td",[a._v("文本内容")])]),a._v(" "),e("tr",[e("td",[a._v("confidence")]),a._v(" "),e("td",[a._v("float")]),a._v(" "),e("td",[a._v("文本识别置信度")])]),a._v(" "),e("tr",[e("td",[a._v("text_region")]),a._v(" "),e("td",[a._v("list")]),a._v(" "),e("td",[a._v("文本位置坐标")])])])]),a._v(" "),e("h2",{attrs:{id:"自定义修改服务模块"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#自定义修改服务模块"}},[a._v("#")]),a._v(" 自定义修改服务模块")]),a._v(" "),e("p",[a._v("如果需要修改服务逻辑，你一般需要操作以下步骤（以修改"),e("code",[a._v("ocr_system")]),a._v("为例）：")]),a._v(" "),e("ul",[e("li",[a._v("1、 停止服务\n"),e("code",[a._v("hub serving stop --port/-p XXXX")])]),a._v(" "),e("li",[a._v("2、 到相应的"),e("code",[a._v("module.py")]),a._v("和"),e("code",[a._v("params.py")]),a._v("等文件中根据实际需求修改代码。\n例如，如果需要替换部署服务所用模型，则需要到"),e("code",[a._v("params.py")]),a._v("中修改模型路径参数"),e("code",[a._v("det_model_dir")]),a._v("和"),e("code",[a._v("rec_model_dir")]),a._v("，如果需要关闭文本方向分类器，则将参数"),e("code",[a._v("use_angle_cls")]),a._v("置为"),e("code",[a._v("False")]),a._v("，当然，同时可能还需要修改其他相关参数，请根据实际情况修改调试。 "),e("strong",[a._v("强烈建议修改后先直接运行"),e("code",[a._v("module.py")]),a._v("调试，能正确运行预测后再启动服务测试。")]),a._v(" "),e("strong",[a._v("注意")]),a._v(" PPOCR-v3识别模型使用的图片输入shape为"),e("code",[a._v("3,48,320")]),a._v(",因此需要修改"),e("code",[a._v("params.py")]),a._v("中的"),e("code",[a._v('cfg.rec_image_shape = "3, 48, 320"')]),a._v("，如果不使用PPOCR-v3识别模型，则无需修改该参数。")]),a._v(" "),e("li",[a._v("3、 卸载旧服务包\n"),e("code",[a._v("hub uninstall ocr_system")])]),a._v(" "),e("li",[a._v("4、 安装修改后的新服务包\n"),e("code",[a._v("hub install deploy/hubserving/ocr_system/")])]),a._v(" "),e("li",[a._v("5、重新启动服务\n"),e("code",[a._v("hub serving start -m ocr_system")])])]),a._v(" "),e("h1",{attrs:{id:"训练模型脚本"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#训练模型脚本"}},[a._v("#")]),a._v(" 训练模型脚本")]),a._v(" "),e("p",[a._v("训练模型有以下几点需要准备：")]),a._v(" "),e("p",[a._v("1、准备数据集，可官网下载或自己用官方PaddleLable标注工具制作")]),a._v(" "),e("p",[a._v("2、下载预训练模型pretrain models")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" PaddleOCR/\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 下载英文PP-OCRv3的预训练模型")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("wget")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-P")]),a._v(" ./pretrain_models/ https://paddleocr.bj.bcebos.com/PP-OCRv3/english/en_PP-OCRv3_rec_train.tar\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 解压模型参数")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" pretrain_models\n"),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("tar")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-xf")]),a._v(" en_PP-OCRv3_rec_train.tar "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("rm")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-rf")]),a._v(" en_PP-OCRv3_rec_train.tar\n")])])]),e("p",[a._v("3、修改预训练模型对应的yml配置文件")]),a._v(" "),e("p",[e("strong",[a._v("如果安装的是cpu版本，将配置文件中的 "),e("code",[a._v("use_gpu")]),a._v(" 字段修改为false")])]),a._v(" "),e("p",[a._v("4、执行命令训练")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# GPU训练 支持单卡，多卡训练")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v('# 训练icdar15英文数据 训练日志会自动保存为 "{save_model_dir}" 下的train.log')]),a._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#单卡训练（训练周期长，不建议）")]),a._v("\npython tools/train.py "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-c")]),a._v(" configs/rec/PP-OCRv3/en_PP-OCRv3_rec.yml "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-o")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("Global.pretrained_model")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("./pretrain_models/en_PP-OCRv3_rec_train/best_accuracy\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#多卡训练，通过--gpus参数指定卡号")]),a._v("\npython "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" paddle.distributed.launch "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--gpus")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v("'0,1,2,3'")]),a._v("  tools/train.py "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-c")]),a._v(" configs/rec/PP-OCRv3/en_PP-OCRv3_rec.yml "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-o")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("Global.pretrained_model")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("./pretrain_models/en_PP-OCRv3_rec_train/best_accuracy\n")])])]),e("h1",{attrs:{id:"模型导出与预测"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#模型导出与预测"}},[a._v("#")]),a._v(" 模型导出与预测")]),a._v(" "),e("p",[a._v("inference 模型（"),e("code",[a._v("paddle.jit.save")]),a._v("保存的模型） 一般是模型训练，把模型结构和模型参数保存在文件中的固化模型，多用于预测部署场景。 训练过程中保存的模型是checkpoints模型，保存的只有模型的参数，多用于恢复训练等。 与checkpoints模型相比，inference 模型会额外保存模型的结构信息，在预测部署、加速推理上性能优越，灵活方便，适合于实际系统集成。")]),a._v(" "),e("p",[a._v("识别模型转inference模型与检测的方式相同，如下：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("# -c 后面设置训练算法的yml配置文件\n# -o 配置可选参数\n# Global.pretrained_model 参数设置待转换的训练模型地址，不用添加文件后缀 .pdmodel，.pdopt或.pdparams。\n# Global.save_inference_dir参数设置转换的模型将保存的地址。\n\npython3 tools/export_model.py -c configs/rec/PP-OCRv3/ch_PP-OCRv3_rec.yml -o Global.pretrained_model=./pretrain_models/ch_PP-OCRv3_rec_train/best_accuracy  Global.save_inference_dir=./inference/ch_PP-OCRv3_rec/\n")])])]),e("p",[a._v("**注意：**如果是在自己的数据集上训练的模型，并且调整了中文字符的字典文件，请注意修改配置文件中的"),e("code",[a._v("character_dict_path")]),a._v("为自定义字典文件。")]),a._v(" "),e("p",[a._v("转换成功后，在目录下有三个文件：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("inference/en_PP-OCRv3_rec/\n    ├── inference.pdiparams         # 识别inference模型的参数文件\n    ├── inference.pdiparams.info    # 识别inference模型的参数信息，可忽略\n    └── inference.pdmodel           # 识别inference模型的program文件\n")])])]),e("ul",[e("li",[e("p",[a._v("自定义模型推理")]),a._v(" "),e("p",[a._v("如果训练时修改了文本的字典，在使用inference模型预测时，需要通过"),e("code",[a._v("--rec_char_dict_path")]),a._v("指定使用的字典路径，更多关于推理超参数的配置与解释，请参考："),e("a",{attrs:{href:"https://gitee.com/paddlepaddle/PaddleOCR/blob/release/2.6/doc/doc_ch/inference_args.md",target:"_blank",rel:"noopener noreferrer"}},[a._v("模型推理超参数解释教程"),e("OutboundLink")],1),a._v("。")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v('python3 tools/infer/predict_rec.py --image_dir="./doc/imgs_words_en/word_336.png" --rec_model_dir="./your inference model" --rec_image_shape="3, 48, 320" --rec_char_dict_path="your text dict path"\n')])])])])]),a._v(" "),e("h1",{attrs:{id:"从一个服务器登录到另一个服务器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#从一个服务器登录到另一个服务器"}},[a._v("#")]),a._v(" 从一个服务器登录到另一个服务器")]),a._v(" "),e("p",[a._v("例：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("ssh root@192.168.0.12\n")])])]),e("h1",{attrs:{id:"从一个服务器传输文件到另一个服务器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#从一个服务器传输文件到另一个服务器"}},[a._v("#")]),a._v(" 从一个服务器传输文件到另一个服务器")]),a._v(" "),e("p",[a._v("首先两台服务器必须是可以ping通\n1、复制文件\n格式：\nscp 目录/文件名.文件格式 目标服务器用户名@ip地址：目标服务器目录\n例：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("scp /backup/test/md3/export.sh iainst11@10.22.137.11:/ssx/dev/md\n")])])]),e("p",[a._v("2、复制目录（包括目录下的文件）")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("scp -r /backup/test/md3 iainst11@10.22.137.11:/ssx/dev/md\n\nscp -P port filename root@ip:/xxx/xxx\n")])])]),e("h1",{attrs:{id:"curl命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#curl命令"}},[a._v("#")]),a._v(" curl命令")]),a._v(" "),e("h2",{attrs:{id:"_1、发送get请求"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1、发送get请求"}},[a._v("#")]),a._v(" 1、发送GET请求")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" URL\n"),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" URL?a"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("b")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("nihao\n")])])]),e("h2",{attrs:{id:"_2、发送post请求"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2、发送post请求"}},[a._v("#")]),a._v(" 2、发送POST请求")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-X")]),a._v(" POST "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v("'a=1&b=nihao'")]),a._v(" URL\n")])])]),e("h2",{attrs:{id:"_3、发送json格式请求"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3、发送json格式请求"}},[a._v("#")]),a._v(" 3、发送json格式请求：")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-H")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Content-Type: application/json"')]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-X")]),a._v(" POST "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('\'{"abc":123,"bcd":"nihao"}\'')]),a._v(" URL\n"),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-H")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Content-Type: application/json"')]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-X")]),a._v(" POST "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" @image.json http://127.0.0.1:8866/predict/ocr_system\n")])])]),e("p",[a._v("其中，"),e("strong",[a._v("-H")]),a._v("代表header头，"),e("strong",[a._v("-X")]),a._v("是指定什么类型请求(POST/GET/HEAD/DELETE/PUT/PATCH)，"),e("strong",[a._v("-d")]),a._v("代表传输什么数据。这几个是最常用的。")]),a._v(" "),e("p",[a._v("查看所有curl命令： man curl或者curl -h\n请求头：H,A,e\n响应头：I,i,D\ncookie：b,c,j\n传输：F(POST),G(GET),T(PUT),X\n输出：o,O,w\n断点续传：r\n调试：v,--trace,--trace-ascii,--trace-time")]),a._v(" "),e("h1",{attrs:{id:"pdserving模型转换"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#pdserving模型转换"}},[a._v("#")]),a._v(" pdserving模型转换")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("python "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" paddle_serving_client.convert "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dirname")]),a._v(" /opt/paddle/PaddleOCR/inference/my_det/ "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n                                         "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--model_filename")]),a._v(" inference.pdmodel          "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n                                         "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--params_filename")]),a._v(" inference.pdiparams       "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n                                         "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--serving_server")]),a._v(" ./my_det_serving/ "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n                                         "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--serving_client")]),a._v(" ./my_det_client/\n")])])]),e("p",[a._v("启动服务可运行如下命令：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("# 启动服务，运行日志保存在log.txt\npython3 web_service.py &>log.txt &\n")])])]),e("div",{staticClass:"language-vim extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vim"}},[e("code",[a._v("# 启动服务，运行日志保存在log"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(".")]),a._v("txt\nnohup python3 "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("u")]),a._v(" web_service"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(".")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("py")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" log"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(".")]),a._v("log "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("&"),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" &\n")])])]),e("p",[a._v("docker run --privileged=true --gpus all -it --name ppocr  -v /opt/ppocr/service:/opt/ppocr/service -p 8866:8866 -d ppocr:1.1 /bin/bash")]),a._v(" "),e("p",[a._v('docker: Error response from daemon: could not select device driver "" with capabilities: [[gpu]].')]),a._v(" "),e("h1",{attrs:{id:"使用gpu报错"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用gpu报错"}},[a._v("#")]),a._v(" 使用GPU报错")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v('Traceback (most recent call last):\n  File "/root/.paddlehub/modules/ocr_system/module.py", line 55, in _initialize\n    _places = os.environ["CUDA_VISIBLE_DEVICES"]\n  File "/usr/lib/python3.7/os.py", line 681, in __getitem__\n    raise KeyError(key) from None\nKeyError: \'CUDA_VISIBLE_DEVICES\'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/bin/hub", line 8, in <module>\n    sys.exit(execute())\n  File "/usr/local/lib/python3.7/dist-packages/paddlehub/commands/utils.py", line 78, in execute\n    status = 0 if com[\'_entry\']().execute(sys.argv[idx:]) else 1\n  File "/usr/local/lib/python3.7/dist-packages/paddlehub/commands/serving.py", line 352, in execute\n    self.start_serving()\n  File "/usr/local/lib/python3.7/dist-packages/paddlehub/commands/serving.py", line 245, in start_serving\n    self.start_single_app_with_args()\n  File "/usr/local/lib/python3.7/dist-packages/paddlehub/commands/serving.py", line 221, in start_single_app_with_args\n    self.preinstall_modules()\n  File "/usr/local/lib/python3.7/dist-packages/paddlehub/commands/serving.py", line 152, in preinstall_modules\n    m = hub.Module(**init_args)\n  File "/usr/local/lib/python3.7/dist-packages/paddlehub/module/module.py", line 396, in __new__\n    **kwargs)\n  File "/usr/local/lib/python3.7/dist-packages/paddlehub/module/module.py", line 504, in init_with_name\n    user_module._initialize(**kwargs)\n  File "/usr/local/lib/python3.7/dist-packages/paddlehub/compat/paddle_utils.py", line 221, in runner\n    return func(*args, **kwargs)\n  File "/root/.paddlehub/modules/ocr_system/module.py", line 62, in _initialize\n    "Environment Variable CUDA_VISIBLE_DEVICES is not set correctly. If you wanna use gpu, please set CUDA_VISIBLE_DEVICES via export CUDA_VISIBLE_DEVICES=cuda_device_id."\nRuntimeError: Environment Variable CUDA_VISIBLE_DEVICES is not set correctly. If you wanna use gpu, please set CUDA_VISIBLE_DEVICES via export CUDA_VISIBLE_DEVICES=cuda_device_id.\n\n')])])]),e("p",[a._v("提示要设置“CUDA_VISIBLE_DEVICES”\n不知道怎么弄，查找“CUDA_VISIBLE_DEVICES”，找到文章")]),a._v(" "),e("p",[a._v("选择要用的GPU: CUDA_VISIBLE_DEVICES")]),a._v(" "),e("p",[a._v("设置")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("linux:\n在~/.bashrc 的最后加上export CUDA_VISIBLE_DEVICES=1，然后source ~/.bashrc\nwindows:\n打开我的电脑环境变量设置的地方，直接添加就行了。\n")])])]),e("p",[a._v("修改linux系统时区")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\n")])])]),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v('为什公你不口家\n[\n    [\n        {\n            "err": "公"\n        },\n        {\n            "fix": "么"\n        },\n        {\n            "startIdx": "2"\n        },\n        {\n            "endIdx": "3"\n        }\n    ],\n    [\n        {\n            "err": "口"\n        },\n        {\n            "fix": "回"\n        },\n        {\n            "startIdx": "5"\n        },\n        {\n            "endIdx": "6"\n        }\n    ]\n]\n')])])])])}),[],!1,null,null,null);e.default=r.exports}}]);